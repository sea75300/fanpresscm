if(fpcm===void 0)var fpcm={};fpcm.ui={_intVars:{},_autocompletes:{},init:function(){fpcm.ui.mainToolbar=fpcm.dom.fromId("#fpcm-ui-toolbar"),fpcm.dom.bindClick("button[data-fn]",function(e,t){e.preventDefault();let n=t.dataset.fn.split(".");if(!typeof fpcm[n[0]][n[1]]=="function")return!1;let s=null;return t.dataset.fnArg&&(s=t.dataset.fnArg),fpcm[n[0]][n[1]](e,t,s),!1}),fpcm.dom.bindClick(".fpcm.ui-button[data-ui-confirm]",function(e,t){return!t.dataset.uiConfirm||(fpcm.ui_dialogs.confirm({clickYes:function(){t.dataset.uiConfirm="",t.click()}}),!1)},!1,!0),fpcm.ui.showMessages(),fpcm.ui.initJqUiWidgets(),fpcm.ui.initDateTimeMasks(),fpcm.dom.bindEvent("#fpcm-ui-form","submit",function(){return fpcm.ui_loader.show(),!0},!1,!0),fpcm.ui.initShorthelpTooltips(),fpcm.ui.initLightbox(),fpcm.ui.tabs(".fpcm-ui-tabs-general")},initShorthelpTooltips:function(){let t=document.getElementsByClassName("fpcm ui-button-shorthelp");if(!t.length)return!0;for(var n=0;n<t.length;n++)new bootstrap.Tooltip(t[n],{placement:"auto"})},initJqUiWidgets:function(){fpcm.dom.bindClick(".fpcm.ui-button-confirm",function(){return fpcm.ui_loader.hide(),confirm(fpcm.ui.translate("CONFIRM_MESSAGE"))?(fpcm.dom.fromTag(this).data("hidespinner")||fpcm.ui_loader.show(),!0):(fpcm.ui_loader.hide(),!1)},!1,!0),fpcm.ui.initPager()},initLightbox:function(){if(jQuery.fancybox==void 0)return!1;fpcm.dom.fromClass("fpcm.ui-link-fancybox").fancybox({buttons:["zoom","fullScreen","download","close"]})},showMessages:function(){if(window.fpcm.vars.ui.messages===void 0||!fpcm.vars.ui.messages.length)return!1;_boxes="";for(var e in window.fpcm.vars.ui.messages){if(fpcm.vars.ui.messages[e]===void 0)continue;_boxes+=fpcm.ui.createMessageBox(fpcm.vars.ui.messages[e])}fpcm.ui.appendMessageToBody(_boxes)},addMessage:function(e,t){if(t===void 0&&(t=!0),(fpcm.vars.ui.messages===void 0||t)&&(fpcm.vars.ui.messages=[],fpcm.dom.fromClass("fpcm.ui-message").remove()),!e.icon)switch(e.type){case"error":e.icon="exclamation-triangle";break;case"notice":e.icon="check";break;default:e.icon="info-circle";break}e.id||(e.id=fpcm.ui.getUniqueID()),fpcm.ui.langvarExists(e.txt)?e.txt=fpcm.ui.translate(e.txt):e.txtComplete&&(e.txt=e.txtComplete),fpcm.ui.appendMessageToBody(fpcm.ui.createMessageBox(e))},createMessageBox:function(e){var t=" toast";return _mbxId="msgbox-"+e.id,fpcm.dom.fromId(_mbxId).length>0||(e.webnotify?(fpcm.ui_notify.show({body:e.txt}),!0):(e.cbtn="",e.bstm="light",e.type=="error"&&(e.type="danger"),e.type=="neutral"&&(e.type="warning"),e.type=="notice"&&(e.type="success",e.cbtn="btn-close-white"),_msgCode='   <div class="fpcm ui-message shadow '+t+'" role="alert" aria-live="assertive" aria-atomic="true">',_msgCode+='   <div class="toast-header text-white bg-'+e.type+'">',_msgCode+=fpcm.ui.getIcon(e.icon,{size:"2x"}),_msgCode+='   <span class="d-inline-block w-100"></span>',_msgCode+='   <button type="button" class="btn-close '+e.cbtn+'" data-bs-dismiss="toast" data-bs-theme="'+e.bstm+'"  aria-label="'+fpcm.ui.translate("GLOBAL_CLOSE")+'"></button>',_msgCode+="   </div>",_msgCode+='       <div class="toast-body">',_msgCode+='           <div class="mx-3">'+e.txt+"</div>",_msgCode+="       </div>",_msgCode+="   </div>",_msgCode))},appendMessageToBody:function(e){fpcm.dom.appendHtml("#fpcm-body",'<div class="toast-container position-fixed top-0 start-50 translate-middle-x p-3">'+e+"</div>");let n=document.getElementsByClassName("fpcm ui-message");for(var s,t=0;t<n.length;t++)s=new bootstrap.Toast(n[t]),s.show()},translate:function(e){return fpcm.vars.ui.lang[e]===void 0?e:fpcm.vars.ui.lang[e]},langvarExists:function(e){return fpcm.vars.ui.lang[e]!==void 0},assignCheckboxes:function(){if(!fpcm.dom.fromClass("fpcm-select-all").length)return!1;if(fpcm.dom.bindEvent(".fpcm-select-all","change",function(){fpcm.dom.fromClass("fpcm-ui-list-checkbox-sub").prop("checked",!1),fpcm.dom.fromClass("fpcm-ui-list-checkbox").prop("checked",function(e,t){return!t})}),!fpcm.dom.fromClass("fpcm-ui-list-checkbox-sub").length)return!1;fpcm.dom.bindEvent(".fpcm-ui-list-checkbox-sub","change",function(e,t){fpcm.dom.fromClass("fpcm-ui-list-checkbox-subitem"+t.value).prop("checked",function(e,t){return!t})})},selectmenu:function(e,t){let n=fpcm.dom.fromTag(e);t.change&&n.bind("change",function(e){e.preventDefault();try{t.change(e,this)}catch(e){fpcm.ui.addMessage({type:"error",txt:e})}t.resetAfter&&(this.selectedIndex=0)})},progressbar:function(e,t){t===void 0&&(t={});let n=fpcm.dom.fromId("fpcm-progress-"+e).find("div.progress-bar").get(0);if(!n)return!1;t.min===void 0&&(t.min=0),t.max===void 0&&(t.max=0),t.value===void 0&&(t.value=0),t.label===void 0&&(t.label=""),n.setAttribute("ariaValuenow",t.value),n.setAttribute("ariaValuemax",t.max),n.setAttribute("ariaValuemin",t.min),n.innerText=t.label,n.style.width=t.value*100/t.max+"%",n.label&&!n.classList.contains("p-2")&&n.classList.add("p-2"),t.animated&&!n.classList.contains("progress-bar-animated")&&n.classList.add("progress-bar-animated")},autocomplete:function(e,t){if(fpcm.ui._autocompletes[e])return!0;let n={};t.source===void 0&&(t.source=[]),n.data=t.source===void 0||!t.source instanceof Array?[]:t.source,n.highlightTyped=!1;let s=document.querySelector(e);if(s===null)return console.warn("No DOm element found for "+e),!1;if(n.onSelectItem=function(e){s.value=e.value},t.minLength!==void 0&&(n.treshold=t.minLength),t.onRenderItems!==void 0&&(n.onRenderItems=t.onRenderItems),t.showValue!==void 0&&(n.showValue=t.showValue),t.source instanceof Array)return fpcm.ui._autocompletes[e]=new Autocomplete(s,n),!0;n.onInput=function(n){return n.length<this.treshold||!fpcm.ui._autocompletes[e]?(fpcm.ui._autocompletes[e].setData([]),!1):(fpcm.ui._autocompletes[e].setData([]),fpcm.ajax.get(t.source+"&term="+n,{quiet:!0,execDone:function(t){!t instanceof Array&&(t=[]),fpcm.ui._autocompletes[e].setData(t)}}),!1)},fpcm.ui._autocompletes[e]=new Autocomplete(s,n),fpcm.ui._autocompletes[e].setData([])},multiselect:function(e,t){return TomSelect===void 0?(alert('Multiselect ui init error, "TomSelect" not defined. Check if you included the library.'),null):(t||(t={}),t.searchField||(t.searchField=["text","value"]),t.plugins||(t.plugins=[]),t.placeholder||(t.placeholder="EDITOR_CATEGORIES_SEARCH"),t.hidePlaceholder||(t.hidePlaceholder=!0),t.placeholder=fpcm.ui.translate(t.placeholder),t.plugins.push("remove_button"),!!document.getElementById(e)&&new TomSelect("#"+e,t))},createIFrame:function(e){return e.src?(e.classes||(e.classes="w-100"),e.id||(e.id=fpcm.ui.getUniqueID()),e.options||(e.options=[]),e.style=e.style?' style="'+e.style+'"':"",e.options=e.options.length?" "+e.options.join(" "):"",'<iframe src="'+e.src+'" id="'+e.id+'" class="'+e.classes+'"'+e.style+e.options+"></iframe>"):(console.warn("fpcm.ui.createIFrame requires a non-empty value."),"")},getIcon:function(e,t){if(!e)return console.warn("Invalid icon class given!"),"";t||(t={}),t.spinner||(t.spinner=""),t.stack||(t.stack=""),t.size||(t.size="1x"),t.text||(t.text=""),t.class||(t.class="");let n="unstacked";t.stack&&t.stackTop?n="stackedTop":t.stack&&!t.stackTop&&(n="stacked");let s=fpcm.vars.ui.components.icon[n]?fpcm.vars.ui.components.icon[n]:"";return s?s.replace("{{icon}}",e).replace("{{class}}",t.class).replace("{{spinner}}",t.spinner).replace("{{stack}}",t.stack).replace("{{size}}",t.size).replace("{{text}}",t.text).replace("{{prefix}}",t.prefix?t.prefix:fpcm.vars.ui.components.icon.defaultPrefix):""},getTextInput:function(e){return!e||!e.name?(console.warn("Invalid input params given!"),""):(e.id||(e.id=e.name),e.value===void 0&&(e.value=""),e.text===void 0&&(e.text=""),e.placeholder===void 0&&(e.placeholder=""),e.maxlenght===void 0&&(e.maxlenght="255"),e.type===void 0&&(e.type="text"),e.class===void 0&&(e.class=""),fpcm.vars.ui.components.input.replace("{{name}}",e.name).replace("{{id}}",e.id).replace("{{id}}",e.id).replace("{{value}}",e.value).replace("&lbrace;&lbrace;value&rcub;&rcub;",e.value).replace("{{type}}",e.type).replace("{{text}}",e.text).replace("{{text}}",e.text).replace("{{class}}",e.class).replace("{{type}}",e.type).replace("{{placeholder}}",e.placeholder).replace('maxlength="255" ',e.maxlenght?'maxlength="'+e.maxlenght+'" ':""))},initDateTimeMasks:function(){if(!fpcm.vars.jsvars.dtMasks)return!1;fpcm.dom.fromId("system_dtmask").length&&fpcm.ui.autocomplete("#system_dtmask",{source:fpcm.vars.jsvars.dtMasks,minLength:1}),fpcm.dom.fromId("datasystem_dtmask").length&&fpcm.ui.autocomplete("#datasystem_dtmask",{source:fpcm.vars.jsvars.dtMasks,minLength:1}),fpcm.dom.fromId("usermetasystem_dtmask").length&&fpcm.ui.autocomplete("#usermetasystem_dtmask",{source:fpcm.vars.jsvars.dtMasks,minLength:1})},relocate:function(e){e==="self"&&(e=window.location.href),window.location.href=e},openWindow:function(e){return window.open(e)},showCurrentPasswordConfirmation:function(){var e=fpcm.dom.fromId("fpcm-ui-currentpass-box");return!!e.length&&(e.removeClass("fpcm-ui-hidden"),!0)},isHidden:function(e){return e instanceof Object||(e=fpcm.dom.fromTag(e)),!!e.hasClass("fpcm ui-hidden")||!!e.hasClass("fpcm-ui-hidden")},getUniqueID:function(e){return(new Date).getMilliseconds()+Math.random().toString(36).substr(2,9)+(e||"")},replaceIcon:function(e,t,n){fpcm.dom.fromId(e).find("span.fpcm-ui-icon").removeClass("fa-"+t).addClass("fa-"+n)},darkModeEnabled:function(){return document.documentElement.dataset.bsTheme=="dark"},prepareId:function(e,t){return e.startsWith("#"+fpcm.vars.ui.idPrefix)?e:(e.startsWith("#")&&(e=e.substring(1)),e.startsWith(fpcm.vars.ui.idPrefix)||(e=(t?"":"#")+fpcm.vars.ui.idPrefix+e),e)}},fpcm.ui.forms===void 0&&(fpcm.ui.forms={})