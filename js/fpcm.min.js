/*
 (c) 2015-2018, Stefan Seehafer
 @license http://www.gnu.org/licenses/gpl.txt GPLv3
*/
if(void 0===fpcm)var fpcm={vars:{jsvars:{},ui:{messages:[]}},modules:{},system:{mergeToVars:function(a){a||(a=[]);return jQuery.extend(fpcm,a)}}};
window.onload=function(){"undefined"!==typeof jQuery?(jQuery.noConflict(),fpcm.pub={init:function(){fpcm.pub.doRefresh();jQuery(".fpcm-pub-commentsmiley").click(function(){fpcm.pub.insert(" "+jQuery(this).attr("data-code")+" ");return!1});jQuery(".fpcm-pub-readmore-text").hide();jQuery(".fpcm-pub-readmore-link").click(function(){jQuery("#fpcm-pub-readmore-text-"+jQuery(this).attr("id")).fadeToggle();return!1});jQuery(".fpcm-pub-mentionlink").click(function(){fpcm.pub.insert("@#"+jQuery(this).attr("id")+
": ");return!1});fpcm.pub.shares||(fpcm.pub.shares={});jQuery("a.fpcm-pub-sharebutton-count").click(function(){var a=jQuery(this).attr("data-onclick");if(fpcm.pub.shares[a]&&3E4>(new Date).getTime()-fpcm.pub.shares[a])return!1;fpcm.pub.shares[a]||(fpcm.pub.shares[a]=0);fpcm.pub.shares[a]=(new Date).getTime();fpcm.pub.doAjax({action:"shareClick",type:"POST",data:{oid:jQuery(this).attr("data-oid"),item:a},execDone:function(b){if("likebutton"!==a)return!0;fpcm.pub.addMessage({type:"notice",id:(new Date).getTime(),
txt:fpcm.vars.ui.lang.PUBLIC_SHARE_LIKE});return!1}});return"likebutton"===a?!1:!0});fpcm.pub.showMessages()},insert:function(a){aTag=a;eTag="";a=jQuery("#newcommenttext")[0];a.focus();if("undefined"!=typeof document.selection){a=document.selection.createRange();var b=a.text;a.text=aTag+b+eTag;a=document.selection.createRange();0==b.length?a.move("character",-eTag.length):a.moveStart("character",aTag.length+b.length+eTag.length);a.select()}else if("undefined"!=typeof a.selectionStart){var c=a.selectionStart,
d=a.selectionEnd;b=a.value.substring(c,d);a.value=a.value.substr(0,c)+aTag+b+eTag+a.value.substr(d);c=0==b.length?c+aTag.length:c+aTag.length+b.length+eTag.length;a.selectionStart=c;a.selectionEnd=c}else{for(d=/^[0-9]{0,3}$/;!d.test(c);)c=prompt("Einf\u00fcgen an Position (0.."+a.value.length+"):","0");c>a.value.length&&(c=a.value.length);a.value=a.value.substr(0,c)+aTag+b+eTag+a.value.substr(c)}},addMessage:function(a){if(!jQuery("#fpcm-messages").length)return alert(a.txt),!0;jQuery("#fpcm-messages").append('<div class="fpcm-pub-message-box fpcm-pub-message-'+
a.type+'" id="msgbox-'+a.id+'"><div class="fpcm-pub-message-box-text">'+a.txt+"</div></div>")},showMessages:function(){if(!fpcm.vars.ui||!fpcm.vars.ui.messages||!fpcm.vars.ui.messages.length)return!1;for(var a=0;a<fpcm.vars.ui.messages.length;a++)fpcm.pub.addMessage(fpcm.vars.ui.messages[a]);return!0},doRefresh:function(){if(!fpcm.vars.ajaxActionPath)return!1;fpcm.pub.doAjax({action:"refresh",data:{t:1}});return!0},doAjax:function(a){if(!fpcm.vars.ajaxActionPath&&!a.ajaxActionPath)return console.error("Unable to execute AJAX request due to missing request destination!"),
console.error(a),!1;var b={url:(a.ajaxActionPath?a.ajaxActionPath:fpcm.vars.ajaxActionPath)+a.action,async:void 0!==a.async?a.async:!0,type:a.method?a.method.toUpperCase():"GET"};a.data&&(b.data=a.data);a.dataType&&(b.dataType=a.dataType);a.onCode&&(b.statusCode=a.onCode);jQuery.ajax(b).done(function(b){b.search&&3===b.search("FATAL ERROR:")&&console.error("ERROR MESSAGE: "+errorThrown);if("function"!=typeof a.execDone)return!0;a.execDone(b)}).fail(function(b,d,e){console.error("STATUS MESSAGE: "+
d);console.error("ERROR MESSAGE: "+e);if("function"!=typeof a.execFail)return!0;a.execFail()})}},fpcm.pub.init(),fpcm.modules&&jQuery.each(fpcm.modules,function(a,b){if(!b.init||"function"!==typeof b.init)return!0;b.init()})):console.error("jQuery is no loaded! Check if you included the libary in your page header or enable inclusion in FanPress CM ACP.")};