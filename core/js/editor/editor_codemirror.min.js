if(fpcm===void 0)var fpcm={};fpcm.editor_codemirror={defaultShortKeys:{Enter:function(){fpcm.editor.insertBr()},"Ctrl-B":function(){fpcm.dom.fromId("btnEditor-html-buttonbold").click()},"Ctrl-I":function(){fpcm.dom.fromId("btnEditor-html-buttonitalic").click()},"Ctrl-U":function(){fpcm.dom.fromId("btnEditor-html-buttonunderline").click()},"Ctrl-O":function(){fpcm.dom.fromId("btnEditor-html-buttonstrike").click()},"Shift-Ctrl-F":function(){fpcm.editor.insertColor()},"Ctrl-Y":function(){fpcm.dom.fromId("btnEditor-html-buttonsup").click()},"Shift-Ctrl-Y":function(){fpcm.dom.fromId("btnEditor-html-buttonsub").click()},"Shift-Ctrl-L":function(){fpcm.dom.fromId("btnEditor-html-buttonaleft").click()},"Shift-Ctrl-C":function(){fpcm.dom.fromId("btnEditor-html-buttonacenter").click()},"Shift-Ctrl-R":function(){fpcm.dom.fromId("btnEditor-html-buttonaright").click()},"Shift-Ctrl-J":function(){fpcm.dom.fromId("btnEditor-html-buttonajustify").click()},"Ctrl-Alt-N":function(){fpcm.dom.fromId("btnEditor-html-buttoninsertlist").click()},"Shift-Ctrl-N":function(){fpcm.dom.fromId("btnEditor-html-buttoninsertlistnum").click()},"Shift-Ctrl-Q":function(){fpcm.editor.insertQuote()},"Ctrl-L":function(){fpcm.editor.insertLink()},"Ctrl-P":function(){fpcm.editor.insertPicture()},"Shift-Ctrl-V":function(){fpcm.editor.insertMedia()},"Shift-Ctrl-T":function(){fpcm.editor.insertTable()},"Ctrl-Alt-E":function(){fpcm.editor.insertSmilies()},"Shift-Ctrl-D":function(){fpcm.editor.insertDrafts()},"Shift-Ctrl-I":function(){fpcm.editor.insertSymbol()},"Shift-Ctrl-M":function(){fpcm.editor.insertPageBreak()()},"Shift-Ctrl-B":function(){fpcm.editor.insertIFrame()},"Shift-Ctrl-S":function(){return fpcm.editor.removeTags(),!1}},create:function(e){return params={lineNumbers:!0,lineWrapping:!0,matchBrackets:!0,autoCloseTags:!0,id:e.editorId,mode:"text/html",theme:"fpcm"+(fpcm.ui.darkModeEnabled()?"-dark":""),matchTags:{bothTags:!0},extraKeys:{"Ctrl-Space":"autocomplete"}},e.extraKeys!==void 0&&jQuery.extend(params.extraKeys,e.extraKeys),CodeMirror.fromTextArea(document.getElementById(e.elementId),params)},highlight:function(e){return CodeMirror.runMode(e.input,"text/html",document.getElementById(e.outputId))},initToInstance:function(e,t,n){if(e.doc.somethingSelected())return e.doc.replaceSelection(t+e.doc.getSelection()+n),!0;var s=e.doc.getCursor();return e.doc.replaceRange(t+""+n,s,s),n!=""&&(s.ch=n.length>s.ch?s.ch+t.length:s.ch-n.length,e.doc.setCursor(s)),e.focus(),!0}},fpcm.editor&&(fpcm.editor.initToolbar=function(){return fpcm.dom.fromClass("fpcm-editor-html-click").unbind("click"),fpcm.dom.fromClass("fpcm-editor-html-click").click(function(){return this.dataset.htmltag&&!this.dataset.action?fpcm.editor.insert("<"+this.dataset.htmltag+">","</"+this.dataset.htmltag+">"):this.dataset.action&&this.dataset.htmltag?fpcm.editor[this.dataset.action].call(this,this.dataset.htmltag):this.dataset.action&&fpcm.editor[this.dataset.action].call(),!1}),!0},fpcm.editor.insertThumbByEditor=function(e,t){return fpcm.editor._insertToFields(e,t),!1},fpcm.editor.insertFullByEditor=function(e,t){return fpcm.editor._insertToFields(e,t),!1},fpcm.editor.insertGalleryDisabled=function(e){return e===void 0&&(e=fpcm.vars.jsvars.filemanagerMode),e!==2||top.fpcm.editor.cmInstance===void 0||!!(top.fpcm.editor.cmInstance.doc.getValue()&&fpcm.editor.cmInstance.doc.getValue().search("/gallery")!=-1)},fpcm.editor.insertGalleryByEditor=function(e){return!!e.length&&(fpcm.editor.insert(fpcm.editor.getGalleryReplacement(e),fpcm.vars.jsvars.editorGalleryTagEnd),fpcm.ui_dialogs.close("editor-html-filemanager",!0),fpcm.ui_dialogs.close("editor-html-insertimage"),!1)},fpcm.editor._insertToFields=function(e,t,n){if(!e||!t)return fpcm.ui_dialogs.close("editor-html-filemanager"),!1;switch(self.fileOpenMode){case 1:var i="linksurl",s="linkstext",o="linksrel";break;case 2:i="imagespath",s="imagesalt",o=!1;break}return i&&s&&(self.document.getElementById(i).value=e,self.document.getElementById(s).value=t),o&&n&&(self.document.getElementById(o).value=n),fpcm.ui_dialogs.close("editor-html-filemanager"),!0},fpcm.editor.insert=function(e,t){return fpcm.editor_codemirror.initToInstance(fpcm.editor.cmInstance,e,t)},fpcm.editor.insertBr=function(){if(fpcm.editor.cmInstance.doc.somethingSelected())fpcm.editor.cmInstance.doc.replaceSelection("<p>"+fpcm.editor.cmInstance.doc.getSelection()+`</p>
`);else{var e=fpcm.editor.cmInstance.doc.getCursor(),t=`<br>
`;fpcm.editor.cmInstance.doc.replaceRange(t,e,e),fpcm.editor.cmInstance.focus()}return!1},fpcm.editor.insertFontsize=function(e){aTag='<span style="font-size:'+e+'pt;">',fpcm.editor.insert(aTag,"</span>")},fpcm.editor.insertAlignTags=function(e){aTag='<p style="text-align:'+e+';">',fpcm.editor.insert(aTag,"</p>")},fpcm.editor.insertStyle=function(e){fpcm.editor.insert(' class="'+e+'"',"")},fpcm.editor.insertList=function(e){if(!e)return console.warn("Empty listtype parameter given"),!1;var n,t=new fpcm.ui.forms.input;t.name="list-rows",t.type="number",t.label=fpcm.ui.translate("EDITOR_INSERTTABLE_ROWS"),t.value=1,t.min=1,t.labelIcon=new fpcm.ui.forms.icon,t.labelIcon.icon="keyboard",n=new fpcm.ui.forms.input,n.name="list-type",n.label=fpcm.ui.translate("EDITOR_INSERTLIST_TYPESIGN"),n.value="",n.placehodler="-",n.labelIcon=new fpcm.ui.forms.icon,n.labelIcon.icon="list-ul";let s=fpcm.ui.prepareId("list-type");fpcm.ui_dialogs.insert({id:"editor-html-insertlist",title:"EDITOR_HTML_BUTTONS_LIST"+e.toUpperCase(),icon:{icon:"list"},content:[t,n],dlOnClose:function(){delete fpcm.ui._autocompletes[s]},dlOnOpenAfter:function(){var t=[];if(e=="ol"?t=[{value:"decimal",label:"decimal"},{value:"decimal-leading-zero",label:"decimal-leading-zero"},{value:"lower-roman",label:"lower-roman"},{value:"upper-roman",label:"upper-roman"},{value:"lower-latin",label:"lower-latin"},{value:"upper-latin",label:"upper-latin"}]:t=[{value:"disc",label:"disc"},{value:"circle",label:"circle"},{value:"square",label:"square"}],fpcm.ui._autocompletes[s]!==void 0)return fpcm.ui._autocompletes[s].setData(t),!1;fpcm.ui.autocomplete(s,{source:t})},insertAction:function(){var n=document.getElementById(fpcm.ui.prepareId("list-rows",!0)).value,t=document.getElementById(fpcm.ui.prepareId("list-type",!0)).value;aTag="<"+e+(t?' style="list-style-type:'+t+'"':"")+`>
`;for(i=0;i<n;i++)aTag+=`   <li></li>
`;fpcm.editor.insert(aTag,"</"+e+">")}}),delete(t,n)},fpcm.editor.insertSmilies=function(){fpcm.ui_dialogs.insert({id:"editor-html-insertsmileys",title:"EDITOR_INSERTSMILEY",icon:{icon:"face-smile"},dlOnOpen:function(e){fpcm.ajax.exec("editor/smileys",{quiet:!0,execDone:function(t){e.querySelector(".modal-body").innerHTML=t,fpcm.dom.fromClass("fpcm-editor-htmlsmiley").unbind("click"),fpcm.dom.fromClass("fpcm-editor-htmlsmiley").click(function(){fpcm.editor.insert(" "+fpcm.dom.fromTag(this).data("smileycode")+" ","")})}})}})},fpcm.editor.insertSymbol=function(){fpcm.ui_dialogs.insert({id:"editor-html-insertsymbol",title:"EDITOR_INSERTSYMBOL",content:nkorgJSCharMap.createList(),icon:{icon:"font"}}),nkorgJSCharMap.addClickEvent(function(){return fpcm.editor.insert(fpcm.dom.fromTag(this).data("code"),""),!1})},fpcm.editor.insertColor=function(){fpcm.ui_dialogs.insert({id:"editor-html-insertcolor",title:"EDITOR_INSERTCOLOR",icon:{icon:"palette"},insertAction:function(){var e=fpcm.dom.fromClass("fpcm-ui-editor-colormode:checked").val(),t=fpcm.dom.fromId("colorhexcode").val();fpcm.editor.insert('<span style="'+(e===void 0?"color":e)+":"+(t==""?"#000000":t)+';">',"</span>"),fpcm.dom.fromId("colorhexcode").val(""),fpcm.dom.fromId("color_mode1").prop("checked",!0),fpcm.dom.fromId("color_mode2").prop("checked",!1)},dlOnOpen:function(){var e,t=fpcm.dom.fromId("fpcm-dialog-editor-html-insertcolor").find("div.fpcm-dialog-editor-colors");if(t.empty(),t.length){let n=fpcm.ui.getIcon("square",{prefix:"fas",size:"2x",class:"pb-2"});for(e=0;e<fpcm.vars.jsvars.editorConfig.colors.length;e++)t.append(fpcm.dom.fromTag(n).css("color",fpcm.vars.jsvars.editorConfig.colors[e]).data("color",fpcm.vars.jsvars.editorConfig.colors[e]));fpcm.dom.fromTag("div.fpcm-dialog-editor-colors span").unbind("click"),fpcm.dom.fromTag("div.fpcm-dialog-editor-colors span").click(function(){fpcm.dom.fromId("colorhexcode").val(fpcm.dom.fromTag(this).data("color"))})}}})},fpcm.editor.insertDrafts=function(){fpcm.ui_dialogs.insert({id:"editor-html-insertdraft",title:"EDITOR_HTML_BUTTONS_ARTICLETPL",icon:{icon:"file-alt"},dlOnOpen:function(){fpcm.ui.selectmenu("#tpldraft",{change:function(e,t){return t.value?(fpcm.ajax.exec("editor/draft",{dataType:"json",data:{path:t.value},execDone:function(e){fpcm.editor_codemirror.highlight({input:e.data,outputId:"fpcm-dialog-editor-html-insertdraft-preview"})}}),!1):(fpcm.dom.fromId("fpcm-dialog-editor-html-insertdraft-preview").empty(),!1)}})},dlOnClose:function(){fpcm.dom.fromId("fpcm-dialog-editor-html-insertdraft-preview").empty(),fpcm.dom.resetValuesByIdsSelect(["tpldraft"])},insertAction:function(){fpcm.ajax.exec("editor/draft",{dataType:"json",quiet:!1,data:{path:fpcm.dom.fromId("tpldraft").val()},execDone:function(e){fpcm.editor.cmInstance.doc.setValue(e.data)}})}})},fpcm.editor.insertMedia=function(){fpcm.ui_dialogs.insert({id:"editor-html-insertmedia",title:"EDITOR_INSERTMEDIA",icon:{icon:"play"},dlButtons:[{text:fpcm.ui.translate("GLOBAL_PREVIEW"),icon:"film",click:function(){var e=fpcm.editor.getMediaData(!0);fpcm.dom.assignHtml("#fpcm-dialog-editor-html-insertmedia-preview",'<div class="col-12 col-md-10 my-3">'+e.aTag+e.eTag+"</div>")}}],dlOnOpen:function(){fpcm.dom.fromId("insertposterimg").click(function(){return fpcm.editor.showFileManager(4),!1})},dlOnClose:function(){fpcm.dom.resetValuesByIdsString(["mediapath","mediapath2","mediaposter"]),fpcm.dom.resetValuesByIdsChecked(["autoplay","mediatypev"]),fpcm.dom.resetValuesByIdsChecked(["controls","mediatypea"],!0),fpcm.dom.resetValuesByIdsSelect(["mediaformat","mediaformat2"]),fpcm.dom.fromId("fpcm-dialog-editor-html-insertmedia-preview").empty()},insertAction:function(){var e=fpcm.editor.getMediaData();fpcm.editor.insert(e.aTag,e.eTag)}})},fpcm.editor.insertTable=function(){var e,t=new fpcm.ui.forms.input;t.name="table-rows",t.label=fpcm.ui.translate("EDITOR_INSERTTABLE_ROWS"),t.type="number",t.value=1,t.min=1,t.labelIcon=new fpcm.ui.forms.icon,t.labelIcon.icon="arrow-down",e=new fpcm.ui.forms.input,e.name="table-cols",e.label=fpcm.ui.translate("EDITOR_INSERTTABLE_COLS"),e.type="number",e.value=1,e.min=1,e.labelIcon=new fpcm.ui.forms.icon,e.labelIcon.icon="arrow-right",fpcm.ui_dialogs.insert({id:"editor-html-inserttable",title:"EDITOR_INSERTTABLE",icon:{icon:"table"},content:[t,e],insertAction:function(){let t=parseInt(document.getElementById(fpcm.ui.prepareId("table-rows",!0)).value),n=parseInt(document.getElementById(fpcm.ui.prepareId("table-cols",!0)).value),e=`<table>
`;for(i=0;i<t;i++){e+=`    <tr>
`;for(x=0;x<n;x++)e+=`        <td></td>
`;e+=`    </tr>
`}fpcm.editor.insert(e,"</table>")}}),delete(t,e)},fpcm.editor.insertPicture=function(){fpcm.ui_dialogs.insert({id:"editor-html-insertimage",title:"EDITOR_INSERTPIC",icon:{icon:"images"},dlButtons:[{text:"EDITOR_INSERTPIC_ASLINK",icon:"link",clickClose:!0,click:function(){var e=fpcm.editor.getImageData(!0);fpcm.editor.insert(e.aTag,e.eTag)}}],dlOnOpen:function(){fpcm.ajax.get("autocomplete",{dataType:"json",data:{src:"editorfiles"},execDone:function(e){fpcm.ui.autocomplete("#imagespath",{source:e,minLength:2,select:function(e,t){fpcm.dom.fromId("imagesalt").val(t.item.label)}})}})},dlOnClose:function(){fpcm.dom.resetValuesByIdsString(["imagespath","imagesalt"]),fpcm.dom.resetValuesByIdsSelect(["imagesalign","imagescss"])},insertAction:function(){let e=fpcm.editor.getImageData();fpcm.editor.insert(e.aTag,e.eTag)},fileManagerAction:function(){fileOpenMode=2,fpcm.editor.showFileManager(2)}})},fpcm.editor.insertLink=function(){fpcm.ui_dialogs.insert({id:"editor-html-insertlink",title:"EDITOR_INSERTLINK",icon:{icon:"link"},dlOnOpen:function(){fpcm.ajax.get("autocomplete",{dataType:"json",data:{src:"editorlinks"},execDone:function(e){fpcm.ui.autocomplete("#linksurl",{source:e,minLength:2,select:function(e,t){fpcm.dom.fromId("linkstext").val(t.item.label)}})}}),fpcm.ui.autocomplete("#linksrel",{source:[{value:"external",label:"external"},{value:"nofollow",label:"nofollow"},{value:"noopener",label:"noopener"},{value:"noreferrer",label:"noreferrer"}],minLength:2,select:function(e,t){fpcm.dom.fromId("linkstext").val(t.item.label)}})},dlOnClose:function(){fpcm.dom.resetValuesByIdsString(["linksurl","linkstext"]),fpcm.dom.resetValuesByIdsSelect(["linkstarget","linkscss"])},insertAction:function(){let e=fpcm.dom.getValuesFromIds(["linksurl","linkstext","linkstarget","linkscss","linksrel"]);var t=fpcm.editor.getLinkData(e.linksurl,e.linkstext,e.linkstarget,e.linkscss,e.linksrel);fpcm.editor.insert(t.aTag,t.eTag)},fileManagerAction:function(){fileOpenMode=1,fpcm.editor.showFileManager(2)}})},fpcm.editor.insertPageBreak=function(){fpcm.editor.insert("<p>"+fpcm.vars.jsvars.editorConfig.pageBreakVar,"</p>")},fpcm.editor.insertQuote=function(){fpcm.ui_dialogs.insert({id:"editor-html-insertquote",title:"EDITOR_HTML_BUTTONS_QUOTE",icon:{icon:"quote-left"},dlOnClose:function(){fpcm.dom.resetValuesByIdsString(["quotetext","quotesrc"]),fpcm.dom.resetValuesByIdsChecked(["quotetype1","quotetype2"]),fpcm.dom.fromId("quotetype1").prop("checked",!0)},insertAction:function(){var e={text:fpcm.dom.fromId("quotetext").val(),sources:fpcm.dom.fromId("quotesrc").val(),type:fpcm.dom.fromTag("input.fpcm-ui-editor-quotemode:checked").val()};e.type==="blockquote"&&(e.text=`
<p>`+e.text+`</p>
`),fpcm.editor.insert("<"+e.type+' class="fpcm-articletext-quote"'+(e.sources?' cite="'+e.sources+'"':"")+">"+e.text,"</"+e.type+">")}})},fpcm.editor.removeTags=function(){fpcm.ajax.post("editor/cleartags",{data:{text:fpcm.editor.cmInstance.doc.getValue()},execDone:function(e){fpcm.editor.cmInstance.doc.setValue(e||"")}})},fpcm.editor.restoreSave=function(){if(!confirm(fpcm.ui.translate("CONFIRM_MESSAGE")))return!1;let e=fpcm.vars.jsvars.autoSaveStorage===null;fpcm.dom.fromId("editor-html-buttonrestore").prop(e)-click(function(){return fpcm.vars.jsvars.autoSaveStorage=localStorage.getItem(fpcm.vars.jsvars.editorConfig.autosavePref),fpcm.editor.cmInstance.setValue(fpcm.vars.jsvars.autoSaveStorage),!1})},fpcm.editor.getMediaData=function(e){var n,s=fpcm.dom.fromClass("fpcm-editor-mediatype:checked").val().replace(/[^a-z]/,"");let t=fpcm.dom.getValuesFromIds(["mediapath","mediaposter","mediapath2","mediaformat","mediaformat2","autoplay:checked","controls:checked"]);return n="<"+s+(e?' class="fpcm-full-width"':"")+(t.controls_checked?" controls":""),n+=(t.mediaposter?' poster="'+t.mediaposter+'"':"")+">",n+='<source src="'+t.mediapath+'"'+(t.mediaformat?' type="'+t.mediaformat.match(/[a-z]{5}\/{1}[a-z0-9]{3,}/)+'"':"")+(t.autoplay_checked?" autoplay":"")+">",t.mediapath2&&(n+='<source src="'+t.mediapath2+'"'+(t.mediaformat2?' type="'+t.mediaformat2.match(/[a-z]{5}\/{1}[a-z0-9]{3,}/)+'"':"")+">"),{aTag:n,eTag:"</"+s+">"}},fpcm.editor.getLinkData=function(e,t,n,s,o){return aTag='<a href="'+e+'"',n&&(aTag=aTag+' target="'+n+'"'),s&&(aTag=aTag+' class="'+s+'"'),o&&(aTag=aTag+' rel="'+o+'"'),{aTag:aTag+">"+t,eTag:"</a>"}},fpcm.editor.getImageData=function(e){let t=fpcm.dom.getValuesFromIds(["imagespath","imagesalign","imagesalt","imagescss"]),n={aTag:"",eTag:""};if(t.imagesalign=="right"||t.imagesalign=="left"){if(n.aTag='<img src="'+t.imagespath+'" alt="'+t.imagesalt+'" style="float:'+t.imagesalign+';margin:3px;"',t.imagescss&&!e&&(n.aTag+=' class="'+t.imagescss+'"'),n.aTag+=" />",e){var o,s=fpcm.editor.getLinkData(t.imagespath,n.aTag,"",t.imagescss);n.aTag=s._res.aTag+s.eTag}}else t.imagesalign=="center"?(o='<div style="text-align:'+t.imagesalign+';">',n.aTag='<img src="'+t.imagespath+'" alt="'+t.imagesalt+'"',t.imagescss&&!e&&(n.aTag+=' class="'+t.imagescss+'"'),n.aTag+="/>",e&&(s=fpcm.editor.getLinkData(t.imagespath,n.aTag,"",t.imagescss),n.aTag=s._res.aTag+s.eTag),n.aTag=o+n.aTag+"</div>"):(n.aTag='<img src="'+t.imagespath+'" alt="'+t.imagesalt+'"',t.imagescss&&!e&&(n.aTag+=' class="'+t.imagescss+'"'),n.aTag+=" />",e&&(s=fpcm.editor.getLinkData(t.imagespath,n.aTag,"",t.imagescss),n.aTag=s.aTag+s.eTag));return n},fpcm.editor.insertIFrame=function(){var e=new fpcm.ui.forms.input;e.name="frame-url",e.type="url",e.label=fpcm.ui.translate("EDITOR_LINKURL"),e.value="",e.placeholder="https://",e.labelIcon=new fpcm.ui.forms.icon,e.labelIcon.icon="external-link-alt",fpcm.ui_dialogs.insert({id:"editor-html-insertiframe",title:"EDITOR_HTML_BUTTONS_IFRAME",closeButton:!0,content:e,icon:{icon:"puzzle-piece"},insertAction:function(){let e=fpcm.dom.fromId("fpcm-id-frame-url").val();if(!e)return!1;let t=fpcm.ui.createIFrame({src:e,classes:"fpcm-articletext-iframe",id:"fpcm-articletext-iframe-"+fpcm.ui.getUniqueID()});fpcm.editor.insert(t,"")}}),delete e})