if(fpcm===void 0)var fpcm={};fpcm.templates={init:function(){fpcm.dataview.exists("draftfiles")&&fpcm.dataview.render("draftfiles"),fpcm.ui_tabs.render("#fpcm-tabs-templates",{onRenderHtmlBefore:function(e){return!fpcm.templates.editorInstance||!e.relatedTarget.dataset.tplid||(e.target.dataset.tplid&&(document.getElementById("btnShowpreview").disabled=e.target.dataset.tplid==="tweet"),fpcm.templates.editorInstance.toTextArea(),fpcm.templates.editorInstance=null,fpcm.dom.fromTag(e.relatedTarget.dataset.bsTarget).empty(),!0)}}),fpcm.dom.bindClick("#btnShowpreview",fpcm.templates.saveTemplatePreview),fpcm.dom.bindClick(".fpcm-articletemplates-edit",function(e,t){return fpcm.ui_loader.hide(),fpcm.ui_dialogs.create({title:"TEMPLATE_HL_DRAFTS_EDIT",url:t.attributes.href.value,icon:{icon:"file-code"},closeButton:!0,dlButtons:[{text:"GLOBAL_SAVE",icon:"save",primary:!0,click:function(e){fpcm.dom.findElementInDialogFrame(e,"#btnSaveTemplate").click(),fpcm.ui_loader.hide()}}]}),!1}),fpcm.dom.bindClick("#btnSaveTemplates",function(){fpcm.ui_dialogs.confirm({clickYes:function(){fpcm.ajax.post("templates/save",{data:{content:fpcm.templates.editorInstance.getValue(),tplid:fpcm.dom.fromId("templateid").val()},execDone:function(e){if(e instanceof Object&&e.txt)return fpcm.ui.addMessage(e),!0}})}})})},saveTemplatePreview:function(){let e=fpcm.dom.fromId("templateid").val();if(e==="tweet")return!1;fpcm.ajax.post("templates/savetemp",{quiet:!0,data:{content:fpcm.templates.editorInstance.getValue(),tplid:e},execDone:function(){fpcm.ui_dialogs.create({id:"templatepreview-layer",closeButton:!0,url:fpcm.vars.actionPath+"templates/preview&tid="+fpcm.dom.fromId("templateid").val()})}})},createEditorInstance:function(e){try{fpcm.templates.editorInstance=fpcm.editor_codemirror.create({editorId:"tpleditor"+e,elementId:"content_"+e}),fpcm.templates.editorInstance.setSize("100%","100vh"),fpcm.dom.fromTag("a.fpcm-ui-template-tags").click(function(){var n=fpcm.dom.fromTag(this).attr("data-tag"),e=fpcm.templates.editorInstance.doc,t=e.getCursor();return e.replaceRange(n,t,t),fpcm.templates.editorInstance.focus(),!1}),fpcm.dom.fromClass("fpcm-editor-html-click").click(function(){var e=fpcm.dom.fromTag(this).data("htmltag");return fpcm.editor_codemirror.initToInstance(fpcm.templates.editorInstance,"<"+e+">","</"+e+">"),!1})}catch{return!1}return!0}},fpcm.filemanager={runFileIndexUpdate:function(e){if(!e.files||!e.files)return fpcm.ui.relocate("?module=templates/templates&rg=7"),!1;let n=0;for(var t=0;t<e.result.files.length;t++){if(!e.result.files[t].error)continue;n++}if(n)return!1;fpcm.ui.relocate("?module=templates/templates&rg=7")},getAcceptTypes:function(){return/(\.|\/)(htm|html|txt)$/i},getAcceptTypesArr:function(){return["html","htm","txt","application/xhtml+xml","text/html","text/plain"]}}