if(fpcm===void 0)var fpcm={};fpcm.ui_dialogs={create:function(e){e.clickClose!==void 0&&console.error("_params.clickClose is an undefined param for fpcm.ui_dialogs.create()!"),e.title===void 0&&(e.title=""),e.id===void 0&&(e.id=(new Date).getTime());let t="fpcm-dialog-"+e.id,u="fpcm-ui-dlgbtn-"+e.id+"-",c=fpcm.dom.fromId(t);if(c.length&&(c.hasClass("fpcm ui-dialog-dom")||(e.content=fpcm.dom.fromId(t).html(),e.modalClass="fpcm ui-dialog-dom",fpcm.dom.fromId(t).remove()),e.keepDom=!0),e.dlButtons===void 0&&(e.dlButtons=[]),e.closeButton&&e.dlButtons.push({text:"GLOBAL_CLOSE",icon:"times",clickClose:!0,class:"btn-outline-secondary"}),e.url&&(e.content=fpcm.ui.createIFrame({src:e.url,id:t+"-frame",classes:"w-100 h-100"}),e.useSize||(e.class="modal-fullscreen"),e.modalBodyClass="overflow-hidden"+(e.modalBodyClass?" "+e.modalBodyClass:"")),e.image&&(e.content='<img src = "'+e.image+'" role="presentation" / >'),e.class===void 0&&(e.class=""),e.modalClass===void 0&&(e.modalClass=""),e.modalBodyClass===void 0&&(e.modalBodyClass=""),e.opener===void 0&&(e.opener=""),e.size===void 0&&(e.size="lg"),e.content===void 0&&(e.content=""),(e.scrollable===void 0||e.scrollable===!0)&&(e.class+=" modal-dialog-scrollable"),!fpcm.dom.fromId(t).length){let n=fpcm.vars.ui.dialogTpl;fpcm.dom.appendHtml("#fpcm-body",n.replace("{$title}",fpcm.ui.translate(e.title)).replace(/\{\$id\}/g,t).replace("{$opener}",e.opener).replace("{$content}",e.content).replace("{$class}",e.class).replace("{$modalClass}",e.modalClass).replace("{$modalBodyClass}",e.modalBodyClass).replace("{$size}",e.size?"modal-"+e.size:"").replace("{$icon}",e.icon?fpcm.ui.getIcon(e.icon.icon,e.icon.params):fpcm.ui.getIcon("info")).replace("{$buttons}",""))}let n=document.getElementById(t),s=new bootstrap.Modal(n);e.keepDom?e.dlOnClose&&n.addEventListener("hidden.bs.modal",function(){e.dlOnClose(this,s)},{once:!0}):n.addEventListener("hidden.bs.modal",function(){s.dispose(n),fpcm.dom.fromId(t).remove(),e.dlOnClose&&e.dlOnClose(this,s)},{once:!0}),e.dlOnOpen&&n.addEventListener("show.bs.modal",function(){e.dlOnOpen(this,s)},{once:!0}),s.toggle(n);let o="";if(e.dlButtons!==void 0){let i=document.querySelector("#"+t+" div.modal-footer");i.innerHTML="";for(a in e.dlButtons){if(e.dlButtons[a]==void 0)continue;let t=e.dlButtons[a];t.showLabel===void 0&&(t.showLabel=!0);let r=document.createElement("button");if(r.id=t.id?t.id:fpcm.ui.getUniqueID("fpcm-id-dialogbtn"),r.type="button",r.className="btn"+(t.primary?" btn-primary":"")+(t.class?" "+t.class:""),r.tabIndex=a+1,t.showLabel?r.innerHTML=(t.icon?fpcm.ui.getIcon(t.icon)+' <span class="fpcm-ui-label ps-1">':"")+fpcm.ui.translate(t.text)+(t.icon?"</span>":""):(r.innerHTML=fpcm.ui.getIcon(t.icon),r.title=fpcm.ui.translate(t.text)),t.disabled!==void 0&&(r.disabled=t.disabled),t.click==void 0&&t.clickClose==void 0){i.appendChild(r);continue}r.onclick=function(){try{return t.click&&t.click.call(this,s,r),!!t.clickClose&&(s.toggle(n),!1)}catch(e){fpcm.ui.addMessage({type:"error",txt:e})}},i.appendChild(r),!t.disabled&&(t.primary||t.autofocus)&&(o=r.id)}}if((o||e.dlOnOpenAfter)&&n.addEventListener("shown.bs.modal",function(){o&&document.getElementById(o).focus({focusVisible:!0}),e.dlOnOpenAfter&&e.dlOnOpenAfter(this,s)},{once:!0}),!e.headlines)return!0;let r=fpcm.dom.fromTag(n).find("h3");if(!r.length)return!0;let l=[];for(var a,i=0,d=r.length;i<d;i++){let e=r[i];e.id=t+"-hl-"+i,l.push('<li class="nav-item"><a class="nav-link" href="#'+e.id+'">'+e.innerText+"</a></li>")}fpcm.dom.fromId(t+"-navbar").find("ul").append(l.join("")).removeClass("d-none"),fpcm.dom.fromId(t+"-navbar").removeClass("d-none")},confirm:function(e){e.clickNoDefault===void 0&&(e.clickNoDefault=!0),fpcm.ui_dialogs.create({title:"GLOBAL_CONFIRM",content:fpcm.ui.translate("CONFIRM_MESSAGE"),size:"",icon:{icon:"circle-check"},dlButtons:[{text:"GLOBAL_YES",icon:"check",click:e.clickYes,autofocus:!!e.focusYes,class:"btn-success",clickClose:!0},{text:"GLOBAL_NO",icon:"times",click:e.clickNo,primary:!!e.defaultNo,autofocus:!!e.focusNo,class:"btn-danger",clickClose:e.clickNoDefault}]})},insert:function(e){var t={id:e.id,title:fpcm.ui.translate(e.title)};t.dlButtons=e.dlButtons?e.dlButtons:[],e.fileManagerAction&&t.dlButtons.push({text:"HL_FILES_MNG",icon:"folder-open",click:e.fileManagerAction}),e.insertAction&&t.dlButtons.push({text:"GLOBAL_INSERT",icon:"check",clickClose:!0,click:e.insertAction,primary:!0}),e.dlOnOpen&&(t.dlOnOpen=e.dlOnOpen),e.dlOnClose&&(t.dlOnClose=e.dlOnClose),t.closeButton=!0,e.content&&(t.content=e.content),fpcm.ui_dialogs.create(t)},close:function(e,t){if(!e)return!1;t||(t=!1);var n=!1,s=!1;return e="fpcm-dialog-"+e,n=t?window.parent.document.getElementById(e):document.getElementById(e),n?(s=t?window.parent.bootstrap.Modal.getOrCreateInstance(n):window.bootstrap.Modal.getOrCreateInstance(n),s?(s.toggle(n),!0):(console.warn("Failed to create bootstrap item instance for "+e+"!"),!1)):(console.warn("Item "+e+" not found!"),!1)},initScrollspy:function(e){var t=[].slice.call(document.querySelectorAll("#"+e+' [data-bs-spy="scroll"]'));t.forEach(function(e){bootstrap.ScrollSpy.getOrCreateInstance(e).refresh()})}}