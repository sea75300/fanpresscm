if(fpcm===void 0)var fpcm={};fpcm.installer={currentDbFileIndex:0,init:function(){fpcm.installer.initUi(),fpcm.installer.initDatabase(1,0),jQuery('button.fpcm-installer-next-4').hide()},checkDBData:function(){return sfields=jQuery('.fpcm-installer-data'),sParams={},jQuery.each(sfields,function(d,a){var b=jQuery(a).val(),c=jQuery(a).attr('id').replace('database','');sParams[c]=b}),fpcm.ajax.post('installer/checkdb',{data:{dbdata:sParams},async:!1,execDone:function(a){return jQuery('#fpcm-messages').empty(),a==='1'||a===1?(jQuery('#fpcm-ui-form').submit(),!0):(fpcm.ui.addMessage({txt:fpcm.ui.translate('INSTALLER_DBCONNECTION_FAILEDMSG'),type:'error',id:'errordbtestfailed'}),!1)}}),!1},initDatabase:function(b,a){if(!fpcm.vars.jsvars.sqlFilesCount)return!1;var c=fpcm.ui.progressbar('.fpcm-installer-dbtables',{max:fpcm.vars.jsvars.sqlFilesCount,value:a});fpcm.dom.fromClass('fpcm-ui-progressbar-label').text(fpcm.ui.translate('INSTALLER_CREATETABLES_HEAD')),fpcm.ajax.post('installer/initdb',{quiet:!0,data:{next:b,current:a},execDone:function(a){if(a.data.msg)return fpcm.ui.addMessage(a.data.msg),!1;if(a.data.html)for(var b in a.data.html){let c=a.data.html[b];fpcm.dom.appendHtml('#fpcm-installer-execlist','<div class="row g-0 py-2"><div class="col-12" id="installer-tabs-'+c.tab+'">'+fpcm.ui.getIcon(c.icon,{class:c.class})+fpcm.ui.translate('INSTALLER_CREATETABLES_STEP').replace('{{tablename}}',c.tab)+'</div></div>')}return c.progressbar('option','value',a.current),a.current>=fpcm.vars.jsvars.sqlFilesCount&&!a.next?(fpcm.dom.fromClass('fpcm-ui-progressbar-label').hide(),fpcm.dom.fromTag('button.fpcm-installer-next-4').show(),!0):(fpcm.installer.initDatabase(a.next,a.current),!0)}})},initUi:function(){if(fpcm.ui.tabs('#fpcm-tabs-installer',{disabled:fpcm.vars.jsvars.disabledTabs,active:fpcm.vars.jsvars.activeTab,beforeActivate:function(c,b){var a=b.newTab.find('a').attr('data-backlink');if(!a)return!1;fpcm.ui.relocate(a)}}),jQuery('#btnSubmitNext.fpcm-installer-next-3').click(function(){return fpcm.installer.checkDBData(),!1}),fpcm.vars.jsvars.activeTab==0)return!0}}