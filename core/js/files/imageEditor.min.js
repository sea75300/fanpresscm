if(fpcm===void 0)var fpcm={};fpcm.imageEditor={cropper:null,initEditorDialog:function(e){let t=document.createElement("img");t.setAttribute("id","fpcm-id-dialog-files-imgeditor"),t.setAttribute("src",e.data.url),fpcm.ui_dialogs.create({id:"files-editor",title:"FILE_LIST_EDIT",class:"modal-fullscreen",modalBodyClass:"overflow-hidden",content:t,closeButton:!0,scrollable:!1,directAssignToDom:!0,dlOnOpenAfter:function(){return fpcm.filemanager.cropper=fpcm.cropper.getInstance("dialog-files-imgeditor"),!0},dlOnClose:function(){fpcm.filemanager.cropper=null},dlButtons:[{text:"FILE_LIST_EDIT_ZOOMOUT",icon:"search-minus",showLabel:!1,click:function(){fpcm.filemanager.cropper.zoom(-.2)}},{text:"FILE_LIST_EDIT_ZOOMIN",icon:"search-plus",showLabel:!1,click:function(){fpcm.filemanager.cropper.zoom(.2)}},{text:"FILE_LIST_EDIT_ROTATE_ANTICLOCKWISE",icon:"undo",showLabel:!1,click:function(){fpcm.filemanager.cropper.rotate("-2deg")}},{text:"FILE_LIST_EDIT_ROTATE_CLOCKWISE",icon:"redo",showLabel:!1,click:function(){fpcm.filemanager.cropper.rotate("2deg")}},{text:"FILE_LIST_EDIT_MOVE",icon:"arrow-left",showLabel:!1,click:function(){fpcm.filemanager.cropper.move(-2,0)}},{text:"FILE_LIST_EDIT_MOVE",icon:"arrow-up",showLabel:!1,click:function(){fpcm.filemanager.cropper.move(0,-2)}},{text:"FILE_LIST_EDIT_MOVE",icon:"arrow-down",showLabel:!1,click:function(){fpcm.filemanager.cropper.move(0,2)}},{text:"FILE_LIST_EDIT_MOVE",icon:"arrow-right",showLabel:!1,click:function(){fpcm.filemanager.cropper.move(2,0)}},{text:"FILE_LIST_EDIT_FLIP",icon:"right-left",showLabel:!1,click:function(){fpcm.filemanager.cropper.flipX()}},{text:"FILE_LIST_EDIT_FLIP",icon:"right-left fa-rotate-90",showLabel:!1,click:function(){fpcm.filemanager.cropper.flipY()}},{text:"FILE_LIST_EDIT_RESIZE",icon:"expand-arrows-alt",showLabel:!1,click:function(){let n=fpcm.filemanager.cropper.getSelectionSize();if(!n.width||!n.height)return!1;var e,t=new fpcm.ui.forms.input;t.name="files-editor-width",t.label=fpcm.ui.translate("SYSTEM_OPTIONS_NEWSSHOWMAXIMGSIZEWIDTH"),t.value=n.width,t.type="number",e=new fpcm.ui.forms.input,e.name="files-editor-height",e.label=fpcm.ui.translate("SYSTEM_OPTIONS_NEWSSHOWMAXIMGSIZEHEIGHT"),e.value=n.height,e.type="number",fpcm.ui_dialogs.create({id:"files-editor-save",title:"GLOBAL_SAVE",content:[t,e],closeButton:!0,scrollable:!1,dlButtons:[{text:"GLOBAL_SAVE",icon:"save",clickClose:!0,primary:!0,click:function(){let e=parseInt(document.getElementById(fpcm.ui.prepareId("files-editor-width",!0)).value),t=parseInt(document.getElementById(fpcm.ui.prepareId("files-editor-height",!0)).value);fpcm.filemanager.cropper.resize(e,t)}}]})}},{text:"FILE_LIST_EDIT_DYNAMIC",icon:"lock",showLabel:!1,class:"btn-outline-secondary",click:function(){let s=fpcm.filemanager.cropper.toggleDynamicSelection(),t="fa-lock-open",n="fa-lock";s||(t="fa-lock",n="fa-lock-open"),this.childNodes.item(0).classList.replace(t,n)}},{text:"GLOBAL_RESET",icon:"rotate",showLabel:!1,class:"btn-outline-secondary",click:function(){fpcm.filemanager.cropper.reset()}},{text:"GLOBAL_SAVE",icon:"save",clickClose:!1,primary:!0,click:function(){let o=fpcm.filemanager.cropper.getSelectionSize();if(!o.width||!o.height)return!1;let i=e.data.filename.replace(/^([0-9]{4}-{1}[0-9]{2}\/{1})([a-z0-9_.\-()]+)(\.[a-z0-9]{3,4})$/i,`$2`);var t,n,s=new fpcm.ui.forms.input;s.name="files-editor-filename",s.label=fpcm.ui.translate("FILE_LIST_FILENAME"),s.value=i,s.placeholder=i+".png",t=new fpcm.ui.forms.input,t.name="files-editor-width",t.label=fpcm.ui.translate("SYSTEM_OPTIONS_NEWSSHOWMAXIMGSIZEWIDTH"),t.value=o.width,t.type="number",n=new fpcm.ui.forms.input,n.name="files-editor-height",n.label=fpcm.ui.translate("SYSTEM_OPTIONS_NEWSSHOWMAXIMGSIZEHEIGHT"),n.value=o.height,n.type="number",fpcm.ui_dialogs.create({id:"files-editor-save",title:"GLOBAL_SAVE",content:[s,t,n],closeButton:!0,scrollable:!1,dlButtons:[{text:"GLOBAL_SAVE",icon:"save",clickClose:!0,primary:!0,click:function(){let o=parseInt(document.getElementById(fpcm.ui.prepareId("files-editor-width",!0)).value),i=parseInt(document.getElementById(fpcm.ui.prepareId("files-editor-height",!0)).value);(o!==t.value||i!==n.value)&&fpcm.filemanager.cropper.resize(o,i);let s=document.getElementById(fpcm.ui.prepareId("files-editor-filename",!0));if(!s.value||!s.value.match(/^[a-z0-9_.\-()]+$/i)){fpcm.ui.addMessage({txt:s.validationMessage,type:"error"});return}fpcm.filemanager.cropper.save(s.value,e.afterUpload),fpcm.ui_dialogs.close("files-editor-save")}}]})}}]})}}