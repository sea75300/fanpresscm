if(fpcm===void 0)var fpcm={};fpcm.logs={init:function(){fpcm.ui_tabs.render("#tabs-logs",{reload:!0,onShow:function(e){let t=fpcm.system.parseUrlQuery(e.target.attributes.href.value),s=t.log?t.log:null;s!==fpcm.vars.jsvars.currentLog.name&&(fpcm.vars.jsvars.currentLog.searchterm=""),fpcm.vars.jsvars.currentLog.name=s,fpcm.vars.jsvars.currentLog.key=t.key?t.key:null,fpcm.vars.jsvars.currentLog.system=t.system?t.system:null;let n=new URLSearchParams(e.target.search);fpcm.vars.jsvars.currentLog.searchterm&&fpcm.vars.jsvars.currentLog.searchterm.length>3?n.set("term",fpcm.vars.jsvars.currentLog.searchterm):n.has("term")&&n.delete("term"),e.target.search=n.toString()},onRenderJsonAfter:function(e,t){if(!t.logsize)return!1;let n='<div class="row fpcm-ui-font-small text-body-tertiary">';n+='<div class="col-12 align-self-center p-2">',n+=fpcm.ui.getIcon("weight",{size:"lg"})+fpcm.ui.translate("FILE_LIST_FILESIZE")+": "+t.logsize,n+="</div>",n+="</div>",fpcm.dom.appendHtml(e.target.dataset.bsTarget,n)}}),fpcm.dom.bindClick("#btnCleanLogs",function(){fpcm.ui_dialogs.confirm({focusNo:!0,clickYes:function(){fpcm.logs.clearLogs(fpcm.vars.jsvars.currentLog)}})}),fpcm.dom.bindClick("#btnSearchLogs",function(){var e=new fpcm.ui.forms.input;e.name="log-search-dialog",e.label=fpcm.ui.translate("ARTICLE_SEARCH_TEXT"),e.placeholder=e.label,e.required=!0,fpcm.vars.jsvars.currentLog.searchterm?e.value=fpcm.vars.jsvars.currentLog.searchterm:e.value="",fpcm.ui_dialogs.create({id:"search-logs",title:"ARTICLES_SEARCH",closeButton:!0,content:e,dlButtons:[{text:"ARTICLE_SEARCH_START",icon:"search",primary:!0,autofocus:!1,clickClose:!0,click:function(){let e=document.getElementById("fpcm-id-log-search-dialog");fpcm.vars.jsvars.currentLog.searchterm=e.value.replace(/([^\w\d\s.\-_]+)/i,""),fpcm.logs.reloadLogs()}},{text:fpcm.ui.translate("GLOBAL_RESET"),icon:"filter-circle-xmark",clickClose:!0,click:function(){fpcm.vars.jsvars.currentLog.searchterm="",fpcm.logs.reloadLogs()}}],dlOnOpenAfter:function(){fpcm.dom.setFocus("fpcm-id-log-search-dialog")}})})},clearLogs:function(e){return fpcm.ajax.post("logs/clear",{data:{log:e.name,key:e.key,system:e.system},execDone:function(e){fpcm.logs.reloadLogs(),fpcm.vars.jsvars.currentLog.searchterm="",fpcm.ui.addMessage(e,!0)}}),!1},reloadLogs:function(){let e=fpcm.ui.prepareId("tabs-logs"),t=document.querySelector(e+" a.nav-link.active");fpcm.dom.fromTag(e+" a.nav-link.active").removeClass("active"),new bootstrap.Tab(t).show()}}